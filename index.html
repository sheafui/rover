<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>


    <script src="./dist/cdn.js"></script>

    <link rel="icon" href="data:,">

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <style>
        /* Rule 3: Hide separator if PREVIOUS sibling is a `hidden` option */
        /* :is([data-slot=rover-option],[data-slot=rover-group])[hidden]+[data-slot=rover-separator] { */
        /* display: none; */
        /* } */

        /* Rule 4: Hide separator if NEXT sibling is a `hidden` option */
        /* [data-slot=rover-separator]:has(+ :is([data-slot=rover-option],[data-slot=rover-group])[hidden]) {
            display: none;
        } */
    </style>
</head>

<body class="flex mt-20 justify-center bg-neutral-950">

    <div class="space-y-4" x-rover x-data="selectComponent">
        <div class="w-[360px]">
            <div class="grid grid-cols-[auto_2rem] overflow-hidden">
                <input x-rover:input placeholder="Search..."
                    class="flex-1 col-start-1 col-span-full overflow-hidden row-start-1 w-full rounded-md bg-transparent py-2 text-neutral-300 placeholder-neutral-300 border border-neutral-500 px-4 focus:outline-none" />
                <button x-rover:button type="button"
                    class="col-start-2 row-start-1 border border-white/10 rounded-r-md text-white flex items-center self-center justify-center size-full">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                    </svg>
                </button>
            </div>

            <ul x-rover:options x-cloak
                class="mt-1 max-h-60  w-full rounded-md border border-neutral-700 bg-white/5 text-white overflow-auto shadow-lg focus:outline-none">
                <li class="py-4 text-center" x-rover:empty>
                    No result found
                </li>

                <template x-for="(item, index) in items" x-bind:key="index">
                    <li x-on:click="console.log('clicked', $rover.isOpen)" x-rover:option="item" x-text="item"
                        class="px-4 data-active:bg-white/5 py-2">
                    </li>
                </template>
            </ul>
        </div>
    </div>
</body>

<script>
    document.addEventListener('alpine:init', () => {
        Alpine.data('selectComponent', () => ({
            items: ['tenjarine', 'apple', 'banana', 'cherry', 'orange', 'mango', 'grape'],
            selectedKeys: null,

            init() {
                queueMicrotask(() => {
                    this.$rover.onOpen(() => this.activateSelectedOrFirst());
                });
            },


            activateSelectedOrFirst(activateSelected = true) {
                if (!this.$rover.isOpen) return;

                let activeItem = this.$rover.getActiveItem();

                if (activeItem) return;

                if (activateSelected && this.__selectedKeys) {
                    const keyToActivate = this.__isMultiple
                        ? this.__selectedKeys[0]
                        : this.__selectedKeys;

                    if (keyToActivate) {
                        this.$rover.activate(keyToActivate);
                        return;
                    }
                }

                this.$rover.activateFirst();
            },
        }))
    })
</script>

</html>